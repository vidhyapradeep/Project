
<div ng-controller="LabelCtrl as Labelctrl">
    <div class="container-fluid" ng-controller="StaffAdvanceBalanceCtrl as StaffAdvanceBalanceCtrl">
        <div class="header">
            <span>{{Labelctrl.LabelText.HdStaffAdvanceBalance}}</span>
        </div>

        <div><span style="color: red; margin-left: 30%; margin-bottom: 5%;">{{alertMessage}}</span></div>

        <div class="container_w" ng-init="StaffAdvanceBalanceCtrl.LoadAdvanceBalanceDetailsOfEmployee()">
            <div class="col-lg-3 col-sm-3 col-md-3 col-xs-12">
                <form class="form-inline advance-request">
                    <div class="form-group">
                        <label for="empid">{{Labelctrl.LabelText.LabEmployeeId}}</label>
                        <label>
                            <label ng-repeat="item in AdvOutstandingDetails">{{item.employeeId}}</label>
                        </label>
                    </div>
                    <div class="form-group">
                        <label for="empid">{{Labelctrl.LabelText.LabEmployeeName}}</label>
                        <label ng-repeat="item in AdvOutstandingDetails">{{item.name}}</label>
                    </div>
                    <div class="form-group">
                        <label for="empid">{{Labelctrl.LabelText.LabSalaryCurrency}}</label>
                        <label ng-repeat="item in AdvOutstandingDetails">{{item.currency}} </label>
                    </div>
                    <div class="table-responsive">
                        <table class="table table-bordered table_W tableheader">
                            <thead>
                                <tr>
                                    <th ng-repeat="a in vm.StaffAdvanceBalanceTableTH  track by $index">                                        
                                        <lable>{{a}}</lable>
                                    </th>
                                </tr>
                                <!--<tr>
                                    <th>Advance Rent</th>
                                    <th>Payback Amount</th>
                                    <th>Total Balance</th>
                                </tr>-->
                            </thead>
                            <tbody>
                                <tr ng-repeat="item in AdvOutstandingDetails">
                                    <td class="currency-align">{{item.totalAmount}}</td>
                                    <td class="currency-align">{{item.totalPaidAmount}}</td>
                                    <td class="currency-align">{{item.totalBalance}}</td>
                                </tr>
                            </tbody>
                        </table>

                    </div>
                </form>
            </div>




            <div class="col-lg-1 col-sm-1 col-md-1 col-xs-12"></div>
            <div class="col-lg-8 col-sm-8 col-md-8 col-xs-12">
                <div class="table-responsive">
                    <table class="table table-bordered table_W tableheader">
                        <thead>
                            <tr>
                                <th colspan="10">{{Labelctrl.LabelText.HdMonthlyPayrollDeductions}}</th>
                            </tr>
                            <tr>
                                <th ng-repeat="a in vm.monthlypayrollTableTH  track by $index">
                                    <!--<span ng-if="a.subTh.length==0">{{a.th}}</span>
                                    <lable>{{a.th}}</lable>-->
                                    <lable>{{a}}</lable>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="item in StaffAdvBalPaybackDetails">
                                <td>{{item.salaryPeriod}}</td>
                                <td class="currency-align">{{item.amount}}</td>
                            </tr>
                            <tr class="payslip-summary" ng-repeat="item in StaffAdvBalPaybackDetails  | limitTo:1">

                                <td></td>
                                <td class="currency-align">{{item.sumOfAmount}} </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <hr />
            <div class="container_w">
                <!--            <div class="pull-right marbtn">
                    <button class="btn btn-success">Export</button>
                    <button class="btn btn-primary">Print</button>
                </div>-->
                <!--<div class="table-responsive table payback-check">-->

                <div class="header marbtn">
                    <span>{{Labelctrl.LabelText.HdAdvanceBalanceDetails}}</span>
                </div>


                <!--Norecords Found Start-->
                <div ng-show="StaffAdvanceBalanceCtrl.ShowNRImage==true" class="no-record-found">
                    <img src="../../images/NoRecord.png" />
                </div>
                <!--Norecords Found End-->

                <div ng-show="StaffAdvanceBalanceCtrl.ShowNRImage==false">

                    <div class="table-responsive table payback-check">
                        <div class="pull-right marbtn">
                            <div class="H_search_w">
                                <div class="containerSearch">
                                    <i class="fa fa-search"></i>
                                    <input type="search" id="search" placeholder="Search..." ng-model="q" />
                                </div>
                            </div>
                        </div>
                        <table class="table table-bordered table_W apply_leave tableheader staff-details">
                            <thead>
                                <tr>

                                    <th colspan="7">{{Labelctrl.LabelText.HdLoanHistory}}</th>
                                </tr>
                                <tr>
                                    <th ng-repeat="a in vm.staffAdvanceBalancedetailTableTH  track by $index">
                                        <!--<span ng-if="a.subTh.length==0">{{a.th}}</span>
                                        <lable>{{a.th}}</lable>-->
                                        <lable>{{a}}</lable>
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr ng-repeat="item in StaffAdvMainDetails | filter:q">
                                    <td>{{item.advanceDate}} </td>

                                    <td>{{item.currency}}    </td>

                                    <td class="currency-align">
                                        {{item.amount}}
                                    </td>
                                    <td class="currency-align">
                                        {{item.paidAmount}}
                                    </td>
                                    <td class="currency-align">
                                        {{item.balance}}
                                    </td>

                                    <!--<td class="open-status">{{item.status}}</td>-->
                                    

                                    <td ng-style="{color: item.status=='Open' ? 'green' : item.status=='Closed' ? 'red' : 'Orange'}">{{item.status}}</td>

                                    <!--<td ng-click="StaffAdvanceBalanceCtrl.ViewEMIDetails(item.advanceId)"><u>View</u>-->
                                    <td><a style="color: #8552a2; cursor: pointer;" ng-click="StaffAdvanceBalanceCtrl.ViewEMIDetails(item.advanceId,item.advanceDate,item.currency,item.amount)">View</a></td>
                                </tr>

                            </tbody>
                        </table>

                    </div>
                </div>
                <!--</div>-->
            </div>




            <div class="modal fadein internation-training-details" role="dialog" ng-class="{'active':StaffAdvanceBalanceCtrl.viewEMIForm==true }">
                <div class="modal-dialog modal-lg">
                    <div class="modal-content" style="width: 70%;">
                        <div class="modal-header modal-header-primary">
                            <button type="button" class="close" ng-click="StaffAdvanceBalanceCtrl.ClosePopUp()" data-dismiss="modal">&times;</button>
                            <h4 class="modal-title">{{Labelctrl.LabelText.HdPaybackSchedules}}</h4>
                        </div>

                        <div style="margin: 5px 0 0 30px;">

                            <div>
                                <label style="margin: 7px 15px 7px 0;">{{Labelctrl.LabelText.LabEmployeeId}}</label>
                                <label ng-model="LabelEmployeeId" style="color: #8552a2;">{{LabelEmployeeId}}</label>
                            </div>
                            <div>
                                <label style="margin: 7px 50px 7px 0;">{{Labelctrl.LabelText.LabDate}} </label>
                                <label ng-model="LabelDate" style="color: #8552a2;">{{LabelDate}}</label>
                            </div>
                            <div>
                                <label style="margin: 7px 34px 7px 0;">{{Labelctrl.LabelText.LabAmount}}</label>
                                <label ng-model="LabelAdvAmount" style="color: #8552a2;">{{LabelAdvAmount}}</label>
                            </div>
                            <div>
                                <label style="margin: 7px 30px 7px 0;">{{Labelctrl.LabelText.LabCurrency}}</label>
                                <label ng-model="LabelCurrency" style="color: #8552a2;">{{LabelCurrency}}</label>
                            </div>
                        </div>

                        <!--          <div class="modal-body" ng-init="ViewTaxCtrl.btnViewTaxDetailsClick()">-->
                        <div class="inbox_content padd15" style="margin-top: 10px;">
                            <div class="table-responsive">
                                <table class="table table-bordered table_W tableheader">
                                    <thead>

                                        <tr>
                                            <th ng-repeat="a in vm.paybackscheduleTableTH  track by $index">
                                                <!--<span ng-if="a.subTh.length==0">{{a.th}}</span>
                                                <lable>{{a.th}}</lable>-->
                                                <lable>{{a}}</lable>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-repeat="item in EMIDetailsByAdanceId ">
                                            <td>{{item.salaryPeriod}}</td>
                                            <td>{{item.amount}}</td>
                                            <td>{{item.paidAmount}}</td>
                                            <td>{{item.balance}}</td>

                                        </tr>
                                        <tr class="payslip-summary" ng-repeat="item in EMIDetailsByAdanceId | limitTo:1">
                                            <td>{{Labelctrl.LabelText.LabTotal}}</td>
                                            <td>{{item.sumOfAmount | currency:"":2}}</td>
                                            <td>{{item.sumOfPaidAmount| currency:"":2}}</td>
                                            <td>{{item.sumOfBalance| currency:"":2}}</td>
                                        </tr>

                                    </tbody>
                                </table>
                            </div>

                        </div>
                        <!-- </div>-->
                        <div class="modal-footer">
                            <button type="button" ng-click="StaffAdvanceBalanceCtrl.ClosePopUp()" class="btn btn-purple" data-dismiss="modal">Close</button>
                        </div>
                    </div>
                </div>
            </div>

            <!---------------------No Records Found For View------------------------->

            <div class="modal fadein training-edit-details" role="dialog" ng-class="{'active':StaffAdvanceBalanceCtrl.ShowNoRecordsAvailablePopup}">
                <div class="modal-dialog">
                    <div class="modal-content" style="width: 60%;">
                        <div class="modal-header modal-header-primary">
                            <button type="button" class="close" ng-click="StaffAdvanceBalanceCtrl.ShowNoRecordsAvailablePopup=false;" data-dismiss="modal">&times;</button>
                            <h4 class="modal-title">
                                <!--<i class="fa fa-warning" ></i>-->
                                EMI Form
                            </h4>
                        </div>
                        <div class="modal-body">
                            <form class="form-horizontal">
                                <div>
                                    <div>
                                        <label style="font-size: 18px; font-weight: bold;" ng-model="NoRecords">
                                            <img src="../../images/No-Leave.png" />&nbsp;&nbsp;No Record Found
                                        </label>
                                        <!--{{LeaveApprove}}-->
                                    </div>
                                    </
                                </div>
                            </form>
                        </div>

                        <div class="modal-footer">
                            <button type="button" class="btn btn-purple" ng-click="StaffAdvanceBalanceCtrl.ShowNoRecordsAvailablePopup=false;">Close</button>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>